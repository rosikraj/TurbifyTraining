package com.infinite.security;

import java.io.FileReader;
import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.Properties;
import java.util.Scanner;

import org.apache.log4j.Logger;
import org.apache.log4j.PropertyConfigurator;


public class Employee_Data_Security {
	private static final Logger logger

    = Logger.getLogger(Employee_Data_Security.class);
	public static void main(String[] arg) throws IOException {
		Connection on = null;
		PropertyConfigurator.configure("log4j.properties");
	try {
		//Connection on = null;
		FileReader fr=new FileReader("mysql.properties");
		Properties pr =new Properties();
		pr.load(fr);
		System.out.println(JavaSecurity.decrypt(pr.getProperty("username"),"Rosik"));
		Class.forName("com.mysql.jdbc.Driver"); // loading the drivers
			on =DriverManager.getConnection("jdbc:mysql://localhost:3306/training",JavaSecurity.encrypt("username","Rosik"),JavaSecurity.encrypt("password","Rosik"));//establishing connection
			logger.info("connetion established to database succefully");
			Scanner sc=new Scanner(System.in);
			PreparedStatement ps =on.prepareStatement("Insert into employee value(?,?,?,?)");//create statement
			logger.info("fullName");
			ps.setString(1,sc.next());
			logger.info("idno");
			ps.setInt(2,sc.nextInt());
			
			logger.info("department");
			ps.setString(3,sc.next());
			
			logger.info("gender");
			ps.setString(4,sc.next());
			int status = ps.executeUpdate();
			if(status == 1)
				logger.info("Record inserted Successfully");
			else
				logger.info("Record Failed");
			
	         	/*while (st.next())
	         	{
	         		logger.info(st.getString(1));
	         	}*/
		}
		catch(SQLException e1)
		{
			
			logger.error(e1);
		}
 
        catch(ClassNotFoundException e)
		{
        	logger.error(e);
		}
		
			finally{
				
			
			try{
				on.close();
				
			}
			catch(Exception e1)
			{
				logger.error(e1);
			}
		}
		}
	}

	
	

